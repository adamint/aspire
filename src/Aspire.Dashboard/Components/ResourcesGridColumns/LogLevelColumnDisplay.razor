@namespace Aspire.Dashboard.Components

@using Aspire.Dashboard.Otlp.Model
@using Aspire.Dashboard.Resources
@using Microsoft.Extensions.Logging

@inject IStringLocalizer<ControlsStrings> ControlsStringsLoc

@{
    var id = Guid.NewGuid().ToString();
}

@if (LogEntry.Severity is LogLevel.Error or LogLevel.Critical)
{
    <FluentIcon Id="@id" Icon="Icons.Filled.Size16.ErrorCircle" Color="Color.Error" Class="severity-icon"/>
}
else if (LogEntry.Severity is LogLevel.Warning)
{
    <FluentIcon Id="@id" Icon="Icons.Filled.Size16.Warning" Color="Color.Warning" Class="severity-icon"/>
}

@if (TryGetErrorInformation(out var type, out var message, out var stackTrace))
{
    <FluentTooltip Anchor="@id">
        <pre style="white-space: pre-wrap;">
            @LogEntry.Message
            @type: @message
            @stackTrace
        </pre>
        <FluentButton Appearance="Appearance.Filled">@ControlsStringsLoc[nameof(ControlsStrings.GridValueCopyToClipboard)]</FluentButton>
    </FluentTooltip>
}

@LogEntry.Severity

@code {
    [Parameter, EditorRequired]
    public required OtlpLogEntry LogEntry { get; set; }
}
